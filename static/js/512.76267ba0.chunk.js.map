{"version":3,"file":"static/js/512.76267ba0.chunk.js","mappings":"qDAIA,IAAIA,EAAQ,KAERC,EAAW,KAQf,SAASC,EAAiBC,EAAMC,GAC9B,IAAIC,EAAa,EACbC,EAAQ,EACRC,EAAQ,EAEZ,IAAK,IAAIC,EAAI,EAAGA,EAAIL,EAAKM,OAAQD,IAC/BH,GAAcF,EAAKK,GAAKJ,EAAKI,GAC7BF,GAASH,EAAKK,IAAM,EACpBD,GAASH,EAAKI,IAAM,EAGtB,OAAOH,GAAcK,KAAKC,KAAKL,GAASI,KAAKC,KAAKJ,GACpD,CAcAK,KAAKC,UAAYC,UACf,MAAM,KAAEC,EAAI,QAAEC,GAAYC,EAAMC,KAYhC,GAVa,cAATH,IACFf,QAAcmB,EAAAA,EAAAA,KAAY,uBAAwB,6BAA8B,CAAEC,MAAO,OACzFR,KAAKS,YAAY,CAAEN,KAAM,iBAGd,iBAATA,IACFd,QAAiBkB,EAAAA,EAAAA,KAAY,qBAAsB,0BAA2B,CAAEC,MAAO,OACvFR,KAAKS,YAAY,CAAEN,KAAM,oBAGd,eAATA,EAAuB,CAEzB,IAAKd,EAEH,YADAW,KAAKS,YAAY,CAAEN,KAAM,QAASC,QAAS,6BAI7C,IAAKhB,EAEH,YADAY,KAAKS,YAAY,CAAEN,KAAM,QAASC,QAAS,0BAK7C,MAAMM,EArCV,SAAyBC,GAAwB,IAAlBC,EAASC,UAAAhB,OAAA,QAAAiB,IAAAD,UAAA,GAAAA,UAAA,GAAG,IACzC,MAAME,EAAQJ,EAAKK,MAAM,KACzB,IAAIN,EAAS,GAEb,IAAK,IAAId,EAAI,EAAGA,EAAImB,EAAMlB,OAAQD,GAAKgB,EACrCF,EAAOO,KAAKF,EAAMG,MAAMtB,EAAGA,EAAIgB,GAAWO,KAAK,MAGjD,OAAOT,CACT,CA4BmBU,CAAgBhB,EAAQiB,SAIjCC,SADwBjC,EAASqB,EAAQ,CAAEa,QAAS,OAAQC,WAAW,KACxCC,SAI/BC,SAD6BrC,EAASe,EAAQuB,MAAO,CAAEJ,QAAS,OAAQC,WAAW,KAC7CC,SAEtCG,EAAYlB,EACjBmB,KAAI,CAACC,EAAOlC,KAAC,CACZkC,QACAC,WAAYzC,EAAiBoC,EAAe,GAAIJ,EAAa1B,QAE9DoC,MAAK,CAACC,EAAGC,IAAMA,EAAEH,WAAaE,EAAEF,aAChCb,MAAM,EAAG,GAEJiB,EAAcP,EAAUC,KAAIO,GAAQA,EAAKN,QAGzCO,QAAejD,EAAM,6CAA+CkD,KAAKC,UAAUJ,EAAa,KAAM,GAAK,KAAO/B,EAAQuB,MAAO,CAAEa,eAAgB,GAAIC,eAAgB,MAE7KzC,KAAKS,YAAY,CAAEN,KAAM,YAAaC,QAAS,CAACiC,EAAO,GAAGK,eAAgBd,IAE5E,E,GC1FEe,EAA2B,CAAC,EAGhC,SAASC,EAAoBC,GAE5B,IAAIC,EAAeH,EAAyBE,GAC5C,QAAqB/B,IAAjBgC,EACH,OAAOA,EAAaC,QAGrB,IAAIC,EAASL,EAAyBE,GAAY,CAGjDE,QAAS,CAAC,GAOX,OAHAE,EAAoBJ,GAAUG,EAAQA,EAAOD,QAASH,GAG/CI,EAAOD,OACf,CAGAH,EAAoBM,EAAID,EAGxBL,EAAoBO,EAAI,KAGvB,IAAIC,EAAsBR,EAAoBS,OAAEvC,EAAW,CAAC,MAAM,IAAO8B,EAAoB,OAE7F,OADAQ,EAAsBR,EAAoBS,EAAED,EAClB,E,MCjC3B,IAAIE,EAAW,GACfV,EAAoBS,EAAI,CAAChB,EAAQkB,EAAUC,EAAIC,KAC9C,IAAGF,EAAH,CAMA,IAAIG,EAAeC,IACnB,IAAS/D,EAAI,EAAGA,EAAI0D,EAASzD,OAAQD,IAAK,CACrC2D,EAAWD,EAAS1D,GAAG,GACvB4D,EAAKF,EAAS1D,GAAG,GACjB6D,EAAWH,EAAS1D,GAAG,GAE3B,IAJA,IAGIgE,GAAY,EACPC,EAAI,EAAGA,EAAIN,EAAS1D,OAAQgE,MACpB,EAAXJ,GAAsBC,GAAgBD,IAAaK,OAAOC,KAAKnB,EAAoBS,GAAGW,OAAOC,GAASrB,EAAoBS,EAAEY,GAAKV,EAASM,MAC9IN,EAASW,OAAOL,IAAK,IAErBD,GAAY,EACTH,EAAWC,IAAcA,EAAeD,IAG7C,GAAGG,EAAW,CACbN,EAASY,OAAOtE,IAAK,GACrB,IAAIuE,EAAIX,SACE1C,IAANqD,IAAiB9B,EAAS8B,EAC/B,CACD,CACA,OAAO9B,CArBP,CAJCoB,EAAWA,GAAY,EACvB,IAAI,IAAI7D,EAAI0D,EAASzD,OAAQD,EAAI,GAAK0D,EAAS1D,EAAI,GAAG,GAAK6D,EAAU7D,IAAK0D,EAAS1D,GAAK0D,EAAS1D,EAAI,GACrG0D,EAAS1D,GAAK,CAAC2D,EAAUC,EAAIC,EAuBjB,C,KC3Bdb,EAAoBwB,EAAI,CAACrB,EAASsB,KACjC,IAAI,IAAIJ,KAAOI,EACXzB,EAAoB0B,EAAED,EAAYJ,KAASrB,EAAoB0B,EAAEvB,EAASkB,IAC5EH,OAAOS,eAAexB,EAASkB,EAAK,CAAEO,YAAY,EAAMC,IAAKJ,EAAWJ,IAE1E,ECNDrB,EAAoB8B,EAAI,CAAC,EAGzB9B,EAAoB+B,EAAKC,GACjBC,QAAQC,IAAIhB,OAAOC,KAAKnB,EAAoB8B,GAAGK,QAAO,CAACC,EAAUf,KACvErB,EAAoB8B,EAAET,GAAKW,EAASI,GAC7BA,IACL,KCNJpC,EAAoBqC,EAAKL,GAEjB,aAAeA,EAAf,qBCFRhC,EAAoBsC,SAAYN,IAEf,ECHjBhC,EAAoB0B,EAAI,CAACa,EAAKC,IAAUtB,OAAOuB,UAAUC,eAAeC,KAAKJ,EAAKC,GCAlFxC,EAAoB4C,EAAI,iB,MCIxB,IAAIC,EAAkB,CACrB,IAAK,GAkBN7C,EAAoB8B,EAAE9E,EAAI,CAACgF,EAASI,KAE/BS,EAAgBb,IAElBc,cAAc9C,EAAoB4C,EAAI5C,EAAoBqC,EAAEL,GAE9D,EAGD,IAAIe,EAAqB3F,KAAyB,mBAAIA,KAAyB,oBAAK,GAChF4F,EAA6BD,EAAmB1E,KAAK4E,KAAKF,GAC9DA,EAAmB1E,KAzBCX,IACnB,IAAIiD,EAAWjD,EAAK,GAChBwF,EAAcxF,EAAK,GACnByF,EAAUzF,EAAK,GACnB,IAAI,IAAIuC,KAAYiD,EAChBlD,EAAoB0B,EAAEwB,EAAajD,KACrCD,EAAoBM,EAAEL,GAAYiD,EAAYjD,IAIhD,IADGkD,GAASA,EAAQnD,GACdW,EAAS1D,QACd4F,EAAgBlC,EAASyC,OAAS,EACnCJ,EAA2BtF,EAAK,C,WCrBjC,IAAI2F,EAAOrD,EAAoBO,EAC/BP,EAAoBO,EAAI,IAChBP,EAAoB+B,EAAE,KAAKuB,KAAKD,E,KCDdrD,EAAoBO,G","sources":["worker.js","../webpack/bootstrap","../webpack/runtime/chunk loaded","../webpack/runtime/define property getters","../webpack/runtime/ensure chunk","../webpack/runtime/get javascript chunk filename","../webpack/runtime/get mini-css chunk filename","../webpack/runtime/hasOwnProperty shorthand","../webpack/runtime/publicPath","../webpack/runtime/importScripts chunk loading","../webpack/runtime/startup chunk dependencies","../webpack/startup"],"sourcesContent":["/* eslint-disable no-restricted-globals */\n\nimport { pipeline as hf_pipeline } from '@huggingface/transformers';\n\nlet model = null;\n\nlet embedder = null;\n\n// // Function to load embedder model\n// async function loadEmbedder() {\n//   embedder = await pipeline(\"feature-extraction\", \"Xenova/all-MiniLM-L6-v2\", { dtype: 'q8' });\n// }\n\n// Function to calculate cosine similarity\nfunction cosineSimilarity(vecA, vecB) {\n  let dotProduct = 0;\n  let normA = 0;\n  let normB = 0;\n\n  for (let i = 0; i < vecA.length; i++) {\n    dotProduct += vecA[i] * vecB[i];\n    normA += vecA[i] ** 2;\n    normB += vecB[i] ** 2;\n  }\n\n  return dotProduct / (Math.sqrt(normA) * Math.sqrt(normB));\n}\n\n// Function to split text into chunks\nfunction splitIntoChunks(text, chunkSize = 200) {\n  const words = text.split(\" \");\n  let chunks = [];\n  \n  for (let i = 0; i < words.length; i += chunkSize) {\n    chunks.push(words.slice(i, i + chunkSize).join(\" \"));\n  }\n  \n  return chunks;\n}\n\nself.onmessage = async (event) => {\n  const { type, payload } = event.data;\n\n  if (type === \"loadModel\") {\n    model = await hf_pipeline('text2text-generation', 'Xenova/LaMini-Flan-T5-783M', { dtype: 'q8' });\n    self.postMessage({ type: \"modelLoaded\" });\n  }\n\n  if (type === \"loadEmbedder\") {\n    embedder = await hf_pipeline(\"feature-extraction\", \"Xenova/all-MiniLM-L6-v2\", { dtype: 'q8' });\n    self.postMessage({ type: \"embedderLoaded\" });\n  }\n\n  if (type === \"generation\") {\n\n    if (!embedder) {\n      self.postMessage({ type: \"error\", payload: \"Embedder not loaded yet.\" });\n      return;\n    }\n\n    if (!model) {\n      self.postMessage({ type: \"error\", payload: \"Model not loaded yet.\" });\n      return;\n    }\n\n    // Step 1: Split context into chunks\n    const chunks = splitIntoChunks(payload.context);\n\n    // Step 2: Compute embeddings for each chunk\n    const chunkEmbeddings = await embedder(chunks, { pooling: \"mean\", normalize: true });\n    const chunkVectors = chunkEmbeddings.tolist();\n\n    // Step 3: Compute embedding for the input text\n    const inputEmbeddingTensor = await embedder(payload.input, { pooling: \"mean\", normalize: true });\n    const inputEmbedding = inputEmbeddingTensor.tolist();\n\n    const topChunks = chunks\n    .map((chunk, i) => ({\n      chunk,\n      similarity: cosineSimilarity(inputEmbedding[0], chunkVectors[i]),\n    }))\n    .sort((a, b) => b.similarity - a.similarity) // Sort by similarity\n    .slice(0, 3); // Select top 3\n\n    const chunksArray = topChunks.map(item => item.chunk);\n\n    // model inference with context\n    const result = await model(\"Answer the question based on this context:\" + JSON.stringify(chunksArray, null, 2) + \". \" + payload.input, { min_new_tokens: 50, max_new_tokens: 500 });\n\n    self.postMessage({ type: \"inference\", payload: [result[0].generated_text, topChunks]});\n\n  }\n\n\n};","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n// the startup function\n__webpack_require__.x = () => {\n\t// Load entry module and return exports\n\t// This entry module depends on other loaded chunks and execution need to be delayed\n\tvar __webpack_exports__ = __webpack_require__.O(undefined, [685], () => (__webpack_require__(512)))\n\t__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n\treturn __webpack_exports__;\n};\n\n","var deferred = [];\n__webpack_require__.O = (result, chunkIds, fn, priority) => {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar chunkIds = deferred[i][0];\n\t\tvar fn = deferred[i][1];\n\t\tvar priority = deferred[i][2];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every((key) => (__webpack_require__.O[key](chunkIds[j])))) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.f = {};\n// This file contains only the entry chunk.\n// The chunk loading function for additional chunks\n__webpack_require__.e = (chunkId) => {\n\treturn Promise.all(Object.keys(__webpack_require__.f).reduce((promises, key) => {\n\t\t__webpack_require__.f[key](chunkId, promises);\n\t\treturn promises;\n\t}, []));\n};","// This function allow to reference async chunks and sibling chunks for the entrypoint\n__webpack_require__.u = (chunkId) => {\n\t// return url for filenames based on template\n\treturn \"static/js/\" + chunkId + \".\" + \"9bd085b9\" + \".chunk.js\";\n};","// This function allow to reference async chunks and sibling chunks for the entrypoint\n__webpack_require__.miniCssF = (chunkId) => {\n\t// return url for filenames based on template\n\treturn undefined;\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","__webpack_require__.p = \"/transformers/\";","// no baseURI\n\n// object to store loaded chunks\n// \"1\" means \"already loaded\"\nvar installedChunks = {\n\t512: 1\n};\n\n// importScripts chunk loading\nvar installChunk = (data) => {\n\tvar chunkIds = data[0];\n\tvar moreModules = data[1];\n\tvar runtime = data[2];\n\tfor(var moduleId in moreModules) {\n\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t}\n\t}\n\tif(runtime) runtime(__webpack_require__);\n\twhile(chunkIds.length)\n\t\tinstalledChunks[chunkIds.pop()] = 1;\n\tparentChunkLoadingFunction(data);\n};\n__webpack_require__.f.i = (chunkId, promises) => {\n\t// \"1\" is the signal for \"already loaded\"\n\tif(!installedChunks[chunkId]) {\n\t\tif(true) { // all chunks have JS\n\t\t\timportScripts(__webpack_require__.p + __webpack_require__.u(chunkId));\n\t\t}\n\t}\n};\n\nvar chunkLoadingGlobal = self[\"webpackChunkmy_app\"] = self[\"webpackChunkmy_app\"] || [];\nvar parentChunkLoadingFunction = chunkLoadingGlobal.push.bind(chunkLoadingGlobal);\nchunkLoadingGlobal.push = installChunk;\n\n// no HMR\n\n// no HMR manifest","var next = __webpack_require__.x;\n__webpack_require__.x = () => {\n\treturn __webpack_require__.e(685).then(next);\n};","// run startup\nvar __webpack_exports__ = __webpack_require__.x();\n"],"names":["model","embedder","cosineSimilarity","vecA","vecB","dotProduct","normA","normB","i","length","Math","sqrt","self","onmessage","async","type","payload","event","data","hf_pipeline","dtype","postMessage","chunks","text","chunkSize","arguments","undefined","words","split","push","slice","join","splitIntoChunks","context","chunkVectors","pooling","normalize","tolist","inputEmbedding","input","topChunks","map","chunk","similarity","sort","a","b","chunksArray","item","result","JSON","stringify","min_new_tokens","max_new_tokens","generated_text","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","exports","module","__webpack_modules__","m","x","__webpack_exports__","O","deferred","chunkIds","fn","priority","notFulfilled","Infinity","fulfilled","j","Object","keys","every","key","splice","r","d","definition","o","defineProperty","enumerable","get","f","e","chunkId","Promise","all","reduce","promises","u","miniCssF","obj","prop","prototype","hasOwnProperty","call","p","installedChunks","importScripts","chunkLoadingGlobal","parentChunkLoadingFunction","bind","moreModules","runtime","pop","next","then"],"sourceRoot":""}